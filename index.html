<!DOCTYPE html>

<head>
    <meta charset="UTF-8">
    <title>Rastgele Benzer Haberler...</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.103.0.min.js"></script>
    <style>
    body {
      font-size: 16px;
    }
    
    h1 {
      font-size: 100px;
    }
    
    
    
    
  </style>
    

</head>

<body>

    <button id="myButton_inorder">SIRAYLA</button>
     <script>
        var myButton_inorder = document.getElementById("myButton_inorder");
        
        // Set the CSS styling for the button
        myButton_inorder.style.backgroundColor = "#4CAF50"; // Green background
        myButton_inorder.style.fontsize = "36px"; // Font
        myButton_inorder.style.color = "white"; // White text
        myButton_inorder.style.padding = "24px 48px"; // Add padding
        myButton_inorder.style.border = "none"; // Remove default border
        myButton_inorder.style.borderRadius = "16px"; // Add rounded corners
        myButton_inorder.style.position = "absolute"; // Position the button using absolute positioning
        myButton_inorder.style.top = "300px"; // Set the distance from the top of the page to 100 pixels
        myButton_inorder.style.left = "600px"; // Set the distance from the left of the page to 200 pixels

      </script>
    
     
    
    <h1></h1>
    
    <div id="data"></div>

    <script>
        var randomNum   = 0;
        var index_news  = 0;
        var index_no    = 0;
        
        const dataDisplay = document.getElementById("data");
         $("#data").append("<center><p><h1>" + "HABERLER BEKLENÄ°YOR " + "</h1></p></center>");


         const getData = (() => {
         let data = null;
          
         return async () => {
            if (!data) {
              const response = await fetch('https://m8myq3vscc.execute-api.us-east-1.amazonaws.com/analyze_news/daily_news');
              data = await response.json();
            }
            
            return data;
          }
        })();
        
        
        
        
        let generatedIntegers = [];

        function getRandomIntInRange(min, max) {
          let randomInt = Math.floor(Math.random() * (max - min + 1)) + min;
          
          while (generatedIntegers.includes(randomInt)) {
            randomInt = Math.floor(Math.random() * (max - min + 1)) + min;
          }
          
          generatedIntegers.push(randomInt);
          return randomInt;
        }
        
        
        
        
        
        function displayData(index_no){
            // clear previous data
           dataDisplay.innerHTML = "";
        
           $.each(myData, function(key, value) {
               if (key == "cluster" + index_no) {

                   $.each(value, function(innerkey, innervalue) {

                       if (innerkey == "picture") {
                           $("#data").append("<p>" + " " + "</p>");
                           $("#data").append("<img src=" + innervalue + " width='500' height='300'/>");
                           $("#data").append("<p>" + " " + "</p>");
                       };

                       if (innerkey == "main") {
                           //$("#data").append("<h3>" + innervalue + "</h3>");
                           //$("#data").append("<p>" +" " + "</p>");
                       };

                       if (innerkey == "info") {
                           $.each(innervalue, function(innerInnerkey, innerInnervalue) {
                               $("#data").append("<h4>&nbsp;&nbsp;&nbsp;&nbsp;" + innerInnervalue.title + " ------ " + "<a href=" + innerInnervalue.link + " target='_blank'>" + innerInnervalue.source + "</a>" + "</h4>")
                               //$("#data").append("<a href="  +innerInnervalue.link +" target='_blank'>" + innerInnervalue.source +"</a>");
                               $("#data").append("<p>" + " " + "</p>");

                           });
                       };
                       $("#data").append("<br></br>");

                   });

               };
           });
        
        
        };  
        
        
        let myData;
        getData().then((data) => {
          myData = data;
          if (myData) {
            var lengtofdata = Object.keys(myData).length;
          
          
            console.log(myData); 
            dataDisplay.innerHTML = "";
            $("#data").append("<center><p><h1>" + "HAZIR... " + "</h1></p></center>");
            
            
            
            myButton_inorder.addEventListener('click', function() {  
                                 
                    
                    index_no =    index_news;
                    
                    displayData(index_no);

                    index_news = index_news + 1;
                    
                    if (index_news == lengtofdata){
                        index_news =0;
                        };

            });
            /*
            //var button_random = document.querySelector('#button_random');
            myButton_random.addEventListener('click', function() {  
                    
                    randomNum = getRandomIntInRange(0, lengtofdata);
                    
                    index_no =    randomNum;
                    
                    displayData(index_no);

            });
            */
          } else {
            console.log("Data hasn't been fetched yet");
          }
        });
        
        

        
        
        
       
        
        
        

       
    </script>
</body>

</html>
