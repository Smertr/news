<!DOCTYPE html>

<head>
    <meta charset="UTF-8">
    <title>Rastgele Benzer Haberler...</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.103.0.min.js"></script>
    <style>
    body {
      font-size: 16px;
    }
    
    h1 {
      font-size: 100px;
    }
    </style>

</head>

<body>
    <h1></h1>
    <center>
        <button id="my-button" style="color: green; font: bold 50px Arial ">GETİR</button>
        
    </center>
    <div id="data"></div>

    <script>
        var randomNum = 0;
        var index_news = 0;
        const dataDisplay = document.getElementById("data");
         $("#data").append("<center><p><h1>" + "HABERLER BEKLENİYOR " + "</h1></p></center>");


         const getData = (() => {
         let data = null;
          
         return async () => {
            if (!data) {
              const response = await fetch('https://m8myq3vscc.execute-api.us-east-1.amazonaws.com/analyze_news/daily_news');
              data = await response.json();
            }
            
            return data;
          }
        })();
        
        let myData;
        getData().then((data) => {
          myData = data;
          if (myData) {
          
          
            console.log(myData); 
            dataDisplay.innerHTML = "";
            $("#data").append("<center><p><h1>" + "HABERLER HAZIR " + "</h1></p></center>");
            
            
            var myButton = document.querySelector('#my-button');
                myButton.addEventListener('click', function() {  
                    // clear previous data
                    dataDisplay.innerHTML = "";
        
                    var lengtofdata = Object.keys(myData).length;
                    //randomNum = randomNumInRange(0, lengtofdata);
                        
        
        
                        $.each(myData, function(key, value) {
                            if (key == "cluster" + index_news) {
        
        
        
                                $.each(value, function(innerkey, innervalue) {
        
        
                                    if (innerkey == "picture") {
                                        $("#data").append("<p>" + " " + "</p>");
                                        $("#data").append("<center><img src=" + innervalue + " width='500' height='300'/></center>");
                                        $("#data").append("<p>" + " " + "</p>");
                                    };
        
                                    if (innerkey == "main") {
                                        //$("#data").append("<h3>" + innervalue + "</h3>");
                                        //$("#data").append("<p>" +" " + "</p>");
                                    };
        
                                    if (innerkey == "info") {
                                        $.each(innervalue, function(innerInnerkey, innerInnervalue) {
                                            $("#data").append("<h4>&nbsp;&nbsp;&nbsp;&nbsp;" + innerInnervalue.title + " ------ " + "<a href=" + innerInnervalue.link + " target='_blank'>" + innerInnervalue.source + "</a>" + "</h4>")
                                            //$("#data").append("<a href="  +innerInnervalue.link +" target='_blank'>" + innerInnervalue.source +"</a>");
                                            $("#data").append("<p>" + " " + "</p>");
        
        
        
                                        });
                                    };
                                    $("#data").append("<br></br>");
        
        
                                });
        
                            };
                        });

               

                index_news = index_news + 1;


            });
            // Use myData as needed
          } else {
          
         
            console.log("Data hasn't been fetched yet");
          }
          
        });
        
        

        
        
        
       
        
        
        

       
    </script>
</body>

</html>

