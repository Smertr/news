<!DOCTYPE html>

<head>
    <meta charset="UTF-8">
    <title>Rastgele Benzer Haberler...</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"></link>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.103.0.min.js"></script>
    
    <style>
    body {
      font-size: 16px;
       background-color: #F2F2F2;
    }
    
    h1 {
      font-size: 50px;
    }
    .loading-spinner {
   position: fixed;
   top: 0;
   left: 0;
   width: 100%;
   height: 100%;
   background-color: #F2F2F2;
   z-index: 9999;
   display: flex;
   justify-content: center;
   align-items: center;
 }

 .spinner {
   width: 150px;
   height: 150px;
   border-radius: 50%;
   border-top: 5px solid #387ED8;
   border-right: 5px solid transparent;
   animation: spin 1s linear infinite;
 }

 @keyframes spin {
   to {
     transform: rotate(360deg);
   }
 }
    
    
  </style>
    

</head>

<body>
    



    <div id="data"></div>

    <script>
        var randomNum   = 0;
        var index_news  = 0;
        var index_no    = 0;
        
        const dataDisplay = document.getElementById("data");
         $("#data").append("<div class='loading-spinner'><div class='spinner'></div></div>");
         


         const getData = (() => {
         let data = null;
          
         return async () => {
            if (!data) {
              const response = await fetch('https://m8myq3vscc.execute-api.us-east-1.amazonaws.com/analyze_news/daily_news');
              data = await response.json();
            }
            
            return data;
          }
        })();
        
        
        
        
        let generatedIntegers = [];

        function getRandomIntInRange(min, max) {
          let randomInt = Math.floor(Math.random() * (max - min + 1)) + min;
          
          while (generatedIntegers.includes(randomInt)) {
            randomInt = Math.floor(Math.random() * (max - min + 1)) + min;
          }
          
          generatedIntegers.push(randomInt);
          return randomInt;
        }
        
        
        
        
        
        function displayData(index_no){
            // clear previous data
           dataDisplay.innerHTML = "";
        
           $.each(myData, function(key, value) {
               if (key == "cluster" + index_no) {
                   var str_txt ="";
                   $.each(value, function(innerkey, innervalue) {
                       str_txt = str_txt + "<center>"
                       
                       if (innerkey == "picture") {
                           str_txt = str_txt + "<div class='card' style=' width: 75%;margin-top: 10%;'> <img src= " + innervalue + " style= 'border-radius: 0%; border: 2px solid #555;'></div>"                           
                       };

                       
                       var cnt =0;
                       var lngt = Object.keys(innervalue).length;
                       var block_color = "FFFFFF";
                       
                       if (innerkey == "info") {
                           str_txt = str_txt +"<ul class='list-group' style='color:black; width: 75%; font-size: 2vw; font-family:Arial, sans-serif; ' align='left'>"
                           
                       
                       
                           
                           $.each(innervalue, function(innerInnerkey, innerInnervalue,arr) {
                           
                               str_txt = str_txt + "<li class='list-group-item d-flex justify-content-between align-items-center' style= 'background-color: #"+ block_color+ ";'> "+ innerInnervalue.title + " <a href= " + innerInnervalue.link + " class='badge rounded-pill text-bg-secondary ' target='_blank' style=' font-size: 1.5vw; font-family:Garamond, serif;badge-color: blue;' > "+ innerInnervalue.source +" </a></li>"
                               
                               
                               
                               if (block_color == "FFFFFF"){
                                   block_color = "F2F2F2"
                               }else{
                                   block_color = "FFFFFF"
                               };
                               cnt = cnt+1;
                               
                               
                           
                           
                            

                           });
                          str_txt = str_txt + "</ul></center>"
                          $("#data").append(str_txt)
                       };
                       
                       //$("#data").append("</center>");

                   });

               };
           });
        
        
        };  
        
        
        let myData;
        getData().then((data) => {
          myData = data;
          if (myData) {
            var lengtofdata = Object.keys(myData).length;
            var initial_txt =";"
          
            console.log(myData); 
            dataDisplay.innerHTML = "<br><br><br><br><br>";
            initial_txt = initial_txt+"<div class='row' style= margin-top: 20rem;'>" 
            initial_txt = initial_txt+"<div class='col-sm-6 mb-3 mb-sm-0'><div class='card' style='background-color: #F2F2F2;'><div class='card-body'><h1 class='card-title'>GERİ</h1><h3 class='card-text'>Haberlerde geri gitmek için sayfanın sol tarafında herhangi bir yere tıklayın.</h3>"
            initial_txt = initial_txt+"</div></div></div>"
            initial_txt = initial_txt+"<div class='col-sm-6'><div class='card' style='background-color: #F2F2F2;'><div class='card-body'><h1 class='card-title'>İLERİ</h1><h3 class='card-text'>Haberlerde ileri gitmek için sayfanın sağ tarafında herhangi bir yere tıklayın.</h3>"
            initial_txt = initial_txt+"</div></div></div></div>"
            
                    
                    
            $("#data").append(initial_txt)
            
            
            
            
            
            
            document.addEventListener("click", function(event) {
              var windowWidth = window.innerWidth;
              var clickX = event.clientX;
              
              if (clickX > windowWidth / 2) {
              
              
                index_no =    index_news;
                
                displayData(index_no);

                index_news = index_news + 1;
                
                if (index_news == lengtofdata){
                    index_news =0;
                    };

              }
              else{
              
              if (index_news>=0){
                  index_no =    index_news-2;
                  
                  displayData(index_no);

                  index_news = index_news - 1;
                  
                  if (index_news == lengtofdata){
                      index_news =0;
                      };
              };
              
              
              }
            });

            
            
            /*
            //var button_random = document.querySelector('#button_random');
            myButton_random.addEventListener('click', function() {  
                    
                    randomNum = getRandomIntInRange(0, lengtofdata);
                    
                    index_no =    randomNum;
                    
                    displayData(index_no);

            });
            */
          } else {
            console.log("Data hasn't been fetched yet");
          }
        });
        
        

        
        
        
       
        
        
        

       
    </script>
</body>

</html>
